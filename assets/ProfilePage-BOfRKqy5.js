import{c as y,u as w,a as N,r as n,j as e,U as S}from"./index-CVOoTMyE.js";import{L as p}from"./loader-circle-CVESfS4d.js";import{A as k}from"./arrow-left-DbSgRtZB.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],L=y("save",_),c="/api/auth",f={login:async a=>{const o=await fetch(`${c}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mobile_number:a})});if(!o.ok){const t=await o.json();throw new Error(t.error||"Login failed")}return o.json()},register:async a=>{const o=await fetch(`${c}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!o.ok){const t=await o.json();throw new Error(t.error||"Registration failed")}return o.json()},getProfile:async a=>{const o=await fetch(`${c}/profile/${a}`);if(!o.ok)throw new Error("Failed to fetch profile");return o.json()},updateProfile:async(a,o)=>{const t=await fetch(`${c}/profile/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!t.ok){const d=await t.json();throw new Error(d.error||"Update failed")}return t.json()}},A=()=>{const a=w(),{highContrast:o}=N(),t=localStorage.getItem("citizenId"),[d,g]=n.useState(!0),[u,x]=n.useState(!1),[m,b]=n.useState(null),[j,h]=n.useState(!1),[r,s]=n.useState({full_name:"",age_band:"",income_band:"",occupation:"",mobile_number:""});n.useEffect(()=>{if(!t){a("/onboarding");return}(async()=>{try{const i=await f.getProfile(t);s(i)}catch{b("Failed to load profile data.")}finally{g(!1)}})()},[t,a]);const v=async l=>{if(l.preventDefault(),!!t){x(!0),b(null),h(!1);try{await f.updateProfile(t,r),h(!0),setTimeout(()=>h(!1),3e3)}catch(i){b(i.message||"Failed to update profile.")}finally{x(!1)}}};return d?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] gap-4",children:[e.jsx(p,{className:"w-10 h-10 animate-spin text-blue-600"}),e.jsx("p",{className:"text-xl font-medium",children:"Fetching your profile..."})]}):e.jsxs("div",{className:`max-w-4xl mx-auto p-6 ${o?"bg-black text-yellow-400":"bg-white"}`,children:[e.jsxs("header",{className:"flex items-center gap-4 mb-10",children:[e.jsx("button",{onClick:()=>a("/dashboard"),className:`p-3 rounded-full hover:bg-opacity-20 ${o?"hover:bg-yellow-400":"hover:bg-blue-100 text-blue-600"}`,"aria-label":"Go back to dashboard",children:e.jsx(k,{className:"w-6 h-6"})}),e.jsxs("h1",{className:"text-4xl font-bold flex items-center gap-3",children:[e.jsx(S,{className:"w-10 h-10"})," My Profile"]})]}),m&&e.jsx("div",{className:"mb-6 p-4 bg-red-100 border-l-4 border-red-500 text-red-700",role:"alert",children:m}),j&&e.jsx("div",{className:"mb-6 p-4 bg-green-100 border-l-4 border-green-500 text-green-700",role:"alert",children:"Profile updated successfully!"}),e.jsxs("form",{onSubmit:v,className:"space-y-8",children:[e.jsxs("section",{className:`p-8 rounded-2xl border-2 ${o?"border-yellow-400 bg-gray-900":"border-blue-100 bg-blue-50/30"}`,children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 border-b pb-2",children:"Socioeconomic Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"full_name",className:"block text-lg font-bold mb-2",children:"Full Name"}),e.jsx("input",{id:"full_name",type:"text",value:r.full_name,onChange:l=>s({...r,full_name:l.target.value}),className:`w-full p-4 rounded-xl border-2 transition ${o?"bg-black border-yellow-400 text-white focus:bg-gray-800":"bg-white border-blue-200 focus:border-blue-500 outline-none"}`})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"age_band",className:"block text-lg font-bold mb-2",children:"Age Group"}),e.jsxs("select",{id:"age_band",value:r.age_band,onChange:l=>s({...r,age_band:l.target.value}),className:`w-full p-4 rounded-xl border-2 transition ${o?"bg-black border-yellow-400 text-white":"bg-white border-blue-200 focus:border-blue-500 outline-none"}`,children:[e.jsx("option",{value:"",children:"Select Age Group"}),e.jsx("option",{value:"0-18",children:"Child (0-18)"}),e.jsx("option",{value:"19-35",children:"Youth (19-35)"}),e.jsx("option",{value:"36-60",children:"Adult (36-60)"}),e.jsx("option",{value:"60+",children:"Senior (60+)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"income_band",className:"block text-lg font-bold mb-2",children:"Annual Family Income"}),e.jsxs("select",{id:"income_band",value:r.income_band,onChange:l=>s({...r,income_band:l.target.value}),className:`w-full p-4 rounded-xl border-2 transition ${o?"bg-black border-yellow-400 text-white":"bg-white border-blue-200 focus:border-blue-500 outline-none"}`,children:[e.jsx("option",{value:"",children:"Select Income Band"}),e.jsx("option",{value:"Below 2L",children:"Below ₹2 Lakhs"}),e.jsx("option",{value:"2L - 5L",children:"₹2 Lakhs - ₹5 Lakhs"}),e.jsx("option",{value:"5L - 8L",children:"₹5 Lakhs - ₹8 Lakhs"}),e.jsx("option",{value:"Above 8L",children:"Above ₹8 Lakhs"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"occupation",className:"block text-lg font-bold mb-2",children:"Current Occupation"}),e.jsxs("select",{id:"occupation",value:r.occupation,onChange:l=>s({...r,occupation:l.target.value}),className:`w-full p-4 rounded-xl border-2 transition ${o?"bg-black border-yellow-400 text-white":"bg-white border-blue-200 focus:border-blue-500 outline-none"}`,children:[e.jsx("option",{value:"",children:"Select Occupation"}),e.jsx("option",{value:"Student",children:"Student"}),e.jsx("option",{value:"Self-Employed",children:"Self-Employed"}),e.jsx("option",{value:"Salaried",children:"Salaried"}),e.jsx("option",{value:"Unemployed",children:"Unemployed"})]})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{type:"submit",disabled:u,className:`flex-1 py-4 rounded-2xl font-bold text-xl flex items-center justify-center gap-2 transition-all transform active:scale-95 ${o?"bg-yellow-400 text-black hover:bg-white":"bg-blue-600 text-white hover:bg-blue-700 shadow-lg shadow-blue-200"}`,children:[u?e.jsx(p,{className:"animate-spin"}):e.jsx(L,{})," ",u?"Saving...":"Save Changes"]}),e.jsx("button",{type:"button",onClick:()=>a("/dashboard"),className:`px-8 py-4 rounded-2xl font-bold text-xl transition-all ${o?"border-2 border-yellow-400 text-yellow-400 hover:bg-gray-900":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Cancel"})]})]})]})};export{A as ProfilePage};
